{% extends "appbuilder/base.html" %}
<!-- {% import 'appbuilder/general/lib.html' as lib %} -->

{% block content %}

<script type="text/javascript" src="{{url_for('appbuilder.static',filename='js/createjs-2015.05.21.min.js')}}"></script>
<script type="text/javascript" src="{{url_for('appbuilder.static',filename='js/flow.min.js')}}"></script>

    <!-- <canvas id="canvas1" width="500" height="300"></canvas> -->
<div style = 'width:90%;margin:0 auto;'>
	<h3 align='center'>任务序列</h3>
    <canvas id="canvas2" width="900" height="300"></canvas>
	<h3 align='center'>可靠性分析</h3>
	<canvas id="canvas3" width="900" height="300"></canvas>
</div>
    <!-- <canvas id="canvas3" width="500" height="300"></canvas> -->
    <!-- <canvas id="canvas4" width="500" height="300"></canvas> -->
    
    <script type="text/javascript">
    /* global flowjs */
    
    window.addEventListener("load", func);
    
    function func(){
        console.log("LOADED");
        
 
        var b = new flowjs.DiGraph();
        b.addPaths([
            ["地空导弹任务:DK0001", "任务1", "任务2","任务3","任务6"],
            ["地空导弹任务:DK0001","任务2", "任务4", "任务5","任务7"]
        ]);
        
        var c = new flowjs.DiGraph();
        c.addPaths([
            ["任务: M0182\n时间: 1.4s", "部件:3|置信:88.7   ", "   部件:1|置信:50.7"],
			["任务: M0182\n时间: 1.4s", "部件:7|置信:82.1   ","   部件:6|置信:40.7","   部件:19|置信:38.1"],
			["   部件:19|置信:38.1", "部件:21|置信:37.1"],
			["   部件:19|置信:38.1", "部件:13|置信:36.0"],
			["任务: M0182\n时间: 1.4s", "部件:4|置信:79.1   ","   部件:12|置信:67.8"],
        ]);
        
        var d = new flowjs.DiGraph();
        d.addPaths([
            ["Peter Q", "Gamora", "Nova Prime", "Rocket"],
            ["Drax", "Groot", "Rocket"],
            ["Merdith Q", "Groot"]
        ]);
        
        <!-- new flowjs.DiFlowChart("canvas1", a).draw(); -->
        new flowjs.DiFlowChart("canvas2", b).draw();
		new flowjs.DiFlowChart("canvas3", c).draw();
		
        <!-- new flowjs.DiFlowChart("canvas4", d).draw(); -->
        
        
        // Advanced Example with loading animation
        <!-- var cf = new flowjs.DiFlowChart("canvas3", c); -->
        <!-- cf.draw(); -->
        <!-- simuLoad(cf, c);     -->
    }
    
    
    function simuLoad(flowChart, graph){
        var walker = new flowjs.GraphWalker(graph);
        walker.forEach(function(node){
            var start = Math.random() * 1000 * 5;
            var dur = Math.random() * 1000 * 5;
            simulateLoading(node.id, start);
            simulateDoneLoading(node.id, start + dur);
        }, this);
        
        
        function simulateLoading(itemId, timeout){
            setTimeout(function(){
                flowChart.updateItem(itemId, function(item){
                    item.flowItem.toggleFlashing();
                });
            }, timeout);
            
        }
        
        function simulateDoneLoading(itemId, timeout){
            setTimeout(function(){
                flowChart.updateItem(itemId, function(item){
                    item.flowItem.toggleFlashing();
                    item.flowItem.color = "red";
                    if (item.connectors === undefined){return;}
                    item.connectors.forEach(function(conn){
                       conn.color = "red"; 
                    });
                });
            }, timeout);
        }
    }
        
    </script>


<!-- <div class="col-lg-{{ master_div_width}} col-md-{{ master_div_width}} container"> -->
    <!-- {{ lib.panel_begin(title) }} -->
   	        <!-- {{ widgets.get('list')()|safe }} -->
    <!-- {{ lib.panel_end() }} -->
<!-- </div> -->
<!-- {% for view in related_views %} -->
    <!-- <div class="col-lg-{{ 12 - master_div_width}} col-md-{{ 12 - master_div_width}} container"> -->
        <!-- {{ lib.panel_begin(view.list_title) }} -->
        <!-- <div id="chart_div" style="height:350px"> -->
            <!-- <!-- {{ widgets.get('related_views')[loop.index - 1](pk = pk)|safe }} --> -->
        <!-- </div> -->
        <!-- {{ lib.panel_end() }} -->
    <!-- </div> -->
<!-- {% endfor %} -->

{% endblock %}
